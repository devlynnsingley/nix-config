#!/usr/bin/env bash

set -ex

case $1 in
    vulcan)
        u vulcan update
        u vulcan sign
        nix-copy-hermes.sh &
        push -f src,kadena,doc,Home hermes &
        push athena &
        u vulcan check &
        wait
        notify "Nix on Vulcan updated"
        ;;

    hermes)
        u hermes rebuild travel-ready check
        notify "Nix on Hermes updated"
        ;;

    athena)
        u athena rebuild check
        notify "Nix on Athena updated"
        ;;

    *)
        echo "Unrecognized hostname: $1"
        exit 1
        ;;
esac
